"use strict";(self.webpackChunkchat_application=self.webpackChunkchat_application||[]).push([[403],{403:(e,s,t)=>{t.r(s),t.d(s,{default:()=>y});var a=t(390),r=t(5210),n=t(7424),c=t(1739),i=t(8930),l=t(8144),o=t(1750),d=t(2559);const h=function(e){let{data:s}=e;const t=JSON.parse(localStorage.getItem("user")),h=(0,a.useRef)(null),u=(0,o.v9)((e=>e.darkMode));return(0,a.useEffect)((()=>{var e;null===(e=h.current)||void 0===e||e.scrollIntoView({behaivour:"smooth"})}),[s]),(0,d.jsx)("div",{className:"chat-big-box ",ref:h,children:(0,d.jsx)("div",{className:"chat "+(u?"dark-panel":""),children:(0,d.jsxs)(r.r,{templateColumns:"1fr 14fr",gap:"0.5rem",className:t.user._id==s.sender._id?"myChats":"chats",children:[(0,d.jsx)(n.P,{justifySelf:"left",alignSelf:"start",className:"avatar",children:t.user._id!=s.sender._id&&(0,d.jsx)(c.q,{src:s.sender.resizedPicture,name:"Profile Picture",children:(0,d.jsx)(i.M,{children:(0,d.jsx)(l.Z,{id:"verified-icon-svg"})})})}),(0,d.jsx)(n.P,{fontSize:"1.2rem",children:(0,d.jsxs)("div",{className:t.user._id==s.sender._id?"myChatText":"chatText",children:[t.user._id!=s.sender._id?(0,d.jsxs)("div",{className:"sender-name-time",children:[s.chatId.isGroup?(0,d.jsx)("span",{className:"sender-name",children:s.sender.name}):(0,d.jsx)("span",{}),(0,d.jsx)("span",{className:"sender-chat",children:s.createdAt.split("T")[1].split(".")[0].slice(0,5)})]}):(0,d.jsxs)("div",{className:"sender-name-time",children:[(0,d.jsx)("span",{}),(0,d.jsx)("span",{className:"sender-chat",children:s.createdAt.split("T")[1].split(".")[0].slice(0,5)})]}),(0,d.jsx)("div",{children:s.text})]})})]})})})};var u=t(2333);const f=function(e){let{onSubmit:s}=e;const t=(0,o.v9)((e=>e.darkMode)),[c,i]=(0,a.useState)("");function l(){s(c),i("")}return(0,d.jsxs)(r.r,{templateColumns:"auto 55px",className:"inputBox"+(t?" dark-input":""),children:[(0,d.jsx)(n.P,{children:(0,d.jsx)("input",{id:"chat-input",className:t?"dark-input":"",type:"text",onKeyDown:function(e){"Enter"===e.key&&c&&l()},onChange:function(e){i(e.target.value)},placeholder:"Reply",name:"chat",value:c})}),(0,d.jsx)(n.P,{justifySelf:"center",alignSelf:"center",padding:"13px 15px",children:(0,d.jsx)(u.Z,{onClick:l})})]})};var m=t(4206),p=t(4799),x=t(1023);const j=function(){const e=(0,o.v9)((e=>e.darkMode)),{selectedChat:s}=(0,p.R)(),t=(0,o.I0)();function a(){return JSON.parse(localStorage.getItem("user")).user._id==s.users[0]._id?s.users[1].name:s.users[0].name}return(0,d.jsxs)("div",{className:"header"+(e?" dark-theme-font":""),children:[(0,d.jsxs)(r.r,{className:"name-and-avatar",templateColumns:"1fr 10fr 1fr",gap:"0.5rem",children:[(0,d.jsx)(n.P,{justifySelf:"left",alignSelf:"center",className:"avatar",children:(0,d.jsx)(c.q,{src:s.isGroup?s.picturePath:JSON.parse(localStorage.getItem("user")).user._id==s.users[0]._id?s.users[1].resizedPicture:s.users[0].resizedPicture,onClick:e=>{const s=e.target.src;t((0,x.zI)()),t((0,x.Cf)(s))},name:s.isGroup?s.name:a()})}),(0,d.jsx)(n.P,{fontSize:"1.2rem",paddingLeft:".75rem",className:"chatName",children:(0,d.jsx)("span",{children:s.isGroup?s.name:a()})}),(0,d.jsx)(n.P,{justifySelf:"right",alignSelf:"center",className:"chat-options",children:s.isGroup?(0,d.jsx)(m.d,{className:"headingIcon",boxSize:25}):null})]}),(0,d.jsx)("hr",{})]})};var g=t(4263),S=t(3156);let v,N;const y=function(){const[e,s]=(0,a.useState)([]),[t,c]=(0,a.useState)("Online"),{selectedChat:i,setSelectedChat:l}=(0,p.R)(),[o,u]=(0,a.useState)(!1),m=(0,a.useRef)(null),[x,y]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{v=(0,S.ZP)("http://localhost:8080"),v.on("connect",(()=>u(!0)))}),[]),(0,a.useEffect)((()=>{v.on("message received",(t=>{N&&N._id==t.chatId._id&&s([...e,t])}))})),(0,a.useEffect)((()=>{!async function(){const e=JSON.parse(localStorage.getItem("user"));if(i)try{const t=await fetch("http://localhost:8080/messages/".concat(i._id),{method:"GET",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.token)},redirect:"follow",referrerPolicy:"no-referrer"}),a=await t.json();s(a),v.emit("join chat",i._id)}catch(t){console.log(t)}}(),N=i}),[i]),(0,d.jsxs)(r.r,{templateRows:"1.5fr 8fr 1.5fr",height:"90vh",gap:"10px",children:[(0,d.jsxs)(n.P,{children:[(0,d.jsx)(j,{}),"Offline"==t&&(0,d.jsx)("p",{style:{color:"red",textAlign:"center",backgroundColor:"#ffd400",padding:"6px",margin:"-10px -20px"},children:"You are offline!! Go online to view new chats."})]}),(0,d.jsx)(n.P,{className:"chatBox",ref:m,children:(0,d.jsx)(g.Z,{children:[...e].map((e=>(0,d.jsx)(h,{data:e},e._id)))})}),(0,d.jsx)(n.P,{children:(0,d.jsx)(f,{onSubmit:async function(t){const a=JSON.parse(localStorage.getItem("user")),r={text:t,chatId:i._id};try{const t=await fetch("http://localhost:8080/messages",{method:"POST",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a.token)},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(r)}),n=await t.json();v.emit("newMessage",n),s([...e,n])}catch(n){console.log(n)}}})})]})}}}]);
//# sourceMappingURL=403.42f0e6c5.chunk.js.map